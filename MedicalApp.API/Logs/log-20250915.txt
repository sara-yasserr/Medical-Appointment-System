2025-09-15 23:44:53.956 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-15 23:45:53.139 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-15 23:45:54.005 +03:00 [DBG] Entity Framework Core 9.0.9 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.9' with options: using lazy loading proxies EngineType=SqlServer 
2025-09-15 23:45:55.849 +03:00 [DBG] 'AppDbContext' disposed.
2025-09-15 23:46:55.303 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-09-15 23:46:56.251 +03:00 [DBG] Entity Framework Core 9.0.9 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.9' with options: using lazy loading proxies EngineType=SqlServer 
2025-09-15 23:46:56.519 +03:00 [DBG] Creating DbConnection.
2025-09-15 23:46:56.589 +03:00 [DBG] Created DbConnection. (68ms).
2025-09-15 23:46:56.594 +03:00 [DBG] Migrating using database 'MedicalAppDB' on server '.'.
2025-09-15 23:46:56.598 +03:00 [DBG] Opening connection to database 'MedicalAppDB' on server '.'.
2025-09-15 23:46:57.444 +03:00 [DBG] An error occurred using the connection to database 'MedicalAppDB' on server '.'.
2025-09-15 23:46:57.554 +03:00 [DBG] Creating DbConnection.
2025-09-15 23:46:57.554 +03:00 [DBG] Created DbConnection. (1ms).
2025-09-15 23:46:57.555 +03:00 [DBG] Opening connection to database 'master' on server '.'.
2025-09-15 23:46:57.600 +03:00 [DBG] Opened connection to database 'master' on server '.'.
2025-09-15 23:46:57.608 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-15 23:46:57.619 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (8ms).
2025-09-15 23:46:57.622 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (17ms).
2025-09-15 23:46:57.631 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [MedicalAppDB];
2025-09-15 23:46:59.077 +03:00 [INF] Executed DbCommand (1,436ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [MedicalAppDB];
2025-09-15 23:46:59.079 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-15 23:46:59.079 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-15 23:46:59.079 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-15 23:46:59.080 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [MedicalAppDB] SET READ_COMMITTED_SNAPSHOT ON;
END;
2025-09-15 23:47:00.088 +03:00 [INF] Executed DbCommand (1,009ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [MedicalAppDB] SET READ_COMMITTED_SNAPSHOT ON;
END;
2025-09-15 23:47:00.090 +03:00 [DBG] Closing connection to database 'master' on server '.'.
2025-09-15 23:47:00.098 +03:00 [DBG] Closed connection to database 'master' on server '.' (4ms).
2025-09-15 23:47:00.101 +03:00 [DBG] Disposing connection to database 'master' on server '.'.
2025-09-15 23:47:00.102 +03:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-09-15 23:47:00.102 +03:00 [DBG] Opening connection to database 'MedicalAppDB' on server '.'.
2025-09-15 23:47:00.254 +03:00 [DBG] Opened connection to database 'MedicalAppDB' on server '.'.
2025-09-15 23:47:00.255 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-15 23:47:00.255 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-15 23:47:00.255 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-15 23:47:00.255 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-09-15 23:47:00.480 +03:00 [INF] Executed DbCommand (225ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-09-15 23:47:00.480 +03:00 [DBG] Closing connection to database 'MedicalAppDB' on server '.'.
2025-09-15 23:47:00.480 +03:00 [DBG] Closed connection to database 'MedicalAppDB' on server '.' (0ms).
2025-09-15 23:47:00.480 +03:00 [DBG] Opening connection to database 'MedicalAppDB' on server '.'.
2025-09-15 23:47:00.482 +03:00 [DBG] Opened connection to database 'MedicalAppDB' on server '.'.
2025-09-15 23:47:00.484 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-09-15 23:47:00.487 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-15 23:47:00.487 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-15 23:47:00.487 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-09-15 23:47:00.487 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-09-15 23:47:00.710 +03:00 [INF] Executed DbCommand (222ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-09-15 23:47:00.930 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-15 23:47:00.936 +03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-09-15 23:47:00.937 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-15 23:47:00.937 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-15 23:47:00.938 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-15 23:47:00.938 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-09-15 23:47:00.957 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-09-15 23:47:00.958 +03:00 [DBG] Committing transaction.
2025-09-15 23:47:00.960 +03:00 [DBG] Committed transaction.
2025-09-15 23:47:00.961 +03:00 [DBG] Disposing transaction.
2025-09-15 23:47:00.963 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-09-15 23:47:00.967 +03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-09-15 23:47:00.968 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-15 23:47:00.968 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-15 23:47:00.968 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-15 23:47:00.968 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-09-15 23:47:00.969 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-09-15 23:47:00.969 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-15 23:47:00.969 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-15 23:47:00.969 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-09-15 23:47:00.969 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-09-15 23:47:01.013 +03:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-09-15 23:47:01.055 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-09-15 23:47:01.055 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-09-15 23:47:01.055 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-09-15 23:47:01.056 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-09-15 23:47:01.064 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-09-15 23:47:01.068 +03:00 [DBG] Closing data reader to 'MedicalAppDB' on server '.'.
2025-09-15 23:47:01.069 +03:00 [DBG] A data reader for 'MedicalAppDB' on server '.' is being disposed after spending 3ms reading results.
2025-09-15 23:47:01.075 +03:00 [INF] Applying migration '20250915204555_init'.
2025-09-15 23:47:01.154 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-15 23:47:01.155 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-15 23:47:01.155 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-15 23:47:01.155 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Doctors] (
    [Id] int NOT NULL IDENTITY,
    [FirstName] nvarchar(50) NOT NULL,
    [LastName] nvarchar(50) NOT NULL,
    [Specialization] nvarchar(100) NOT NULL,
    [Email] nvarchar(max) NOT NULL,
    [PhoneNumber] nvarchar(15) NOT NULL,
    CONSTRAINT [PK_Doctors] PRIMARY KEY ([Id])
);
2025-09-15 23:47:01.188 +03:00 [INF] Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Doctors] (
    [Id] int NOT NULL IDENTITY,
    [FirstName] nvarchar(50) NOT NULL,
    [LastName] nvarchar(50) NOT NULL,
    [Specialization] nvarchar(100) NOT NULL,
    [Email] nvarchar(max) NOT NULL,
    [PhoneNumber] nvarchar(15) NOT NULL,
    CONSTRAINT [PK_Doctors] PRIMARY KEY ([Id])
);
2025-09-15 23:47:01.188 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-15 23:47:01.188 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-15 23:47:01.188 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-15 23:47:01.188 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Patients] (
    [Id] int NOT NULL IDENTITY,
    [FirstName] nvarchar(50) NOT NULL,
    [LastName] nvarchar(50) NOT NULL,
    [DateOfBirth] datetime2 NOT NULL,
    [Email] nvarchar(max) NOT NULL,
    [PhoneNumber] nvarchar(20) NOT NULL,
    CONSTRAINT [PK_Patients] PRIMARY KEY ([Id])
);
2025-09-15 23:47:01.191 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Patients] (
    [Id] int NOT NULL IDENTITY,
    [FirstName] nvarchar(50) NOT NULL,
    [LastName] nvarchar(50) NOT NULL,
    [DateOfBirth] datetime2 NOT NULL,
    [Email] nvarchar(max) NOT NULL,
    [PhoneNumber] nvarchar(20) NOT NULL,
    CONSTRAINT [PK_Patients] PRIMARY KEY ([Id])
);
2025-09-15 23:47:01.191 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-15 23:47:01.191 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-15 23:47:01.191 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-15 23:47:01.191 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Appointments] (
    [Id] int NOT NULL IDENTITY,
    [AppointmentDate] datetime2 NOT NULL,
    [Reason] nvarchar(250) NOT NULL,
    [Status] int NOT NULL,
    [PatientId] int NOT NULL,
    [DoctorId] int NOT NULL,
    CONSTRAINT [PK_Appointments] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Appointments_Doctors_DoctorId] FOREIGN KEY ([DoctorId]) REFERENCES [Doctors] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Appointments_Patients_PatientId] FOREIGN KEY ([PatientId]) REFERENCES [Patients] ([Id]) ON DELETE CASCADE
);
2025-09-15 23:47:01.194 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Appointments] (
    [Id] int NOT NULL IDENTITY,
    [AppointmentDate] datetime2 NOT NULL,
    [Reason] nvarchar(250) NOT NULL,
    [Status] int NOT NULL,
    [PatientId] int NOT NULL,
    [DoctorId] int NOT NULL,
    CONSTRAINT [PK_Appointments] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Appointments_Doctors_DoctorId] FOREIGN KEY ([DoctorId]) REFERENCES [Doctors] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Appointments_Patients_PatientId] FOREIGN KEY ([PatientId]) REFERENCES [Patients] ([Id]) ON DELETE CASCADE
);
2025-09-15 23:47:01.320 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-15 23:47:01.320 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-15 23:47:01.320 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-15 23:47:01.320 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Appointments_DoctorId] ON [Appointments] ([DoctorId]);
2025-09-15 23:47:01.341 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Appointments_DoctorId] ON [Appointments] ([DoctorId]);
2025-09-15 23:47:01.341 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-15 23:47:01.341 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-15 23:47:01.341 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-15 23:47:01.341 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Appointments_PatientId] ON [Appointments] ([PatientId]);
2025-09-15 23:47:01.342 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Appointments_PatientId] ON [Appointments] ([PatientId]);
2025-09-15 23:47:01.342 +03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-09-15 23:47:01.342 +03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-15 23:47:01.342 +03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-09-15 23:47:01.342 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250915204555_init', N'9.0.9');
2025-09-15 23:47:01.553 +03:00 [INF] Executed DbCommand (211ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250915204555_init', N'9.0.9');
2025-09-15 23:47:01.554 +03:00 [DBG] Committing transaction.
2025-09-15 23:47:01.556 +03:00 [DBG] Committed transaction.
2025-09-15 23:47:01.556 +03:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-09-15 23:47:01.556 +03:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-09-15 23:47:01.557 +03:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-09-15 23:47:01.557 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-09-15 23:47:01.602 +03:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-09-15 23:47:01.602 +03:00 [DBG] Disposing transaction.
2025-09-15 23:47:01.602 +03:00 [DBG] Closing connection to database 'MedicalAppDB' on server '.'.
2025-09-15 23:47:01.603 +03:00 [DBG] Closed connection to database 'MedicalAppDB' on server '.' (0ms).
2025-09-15 23:47:01.605 +03:00 [DBG] 'AppDbContext' disposed.
2025-09-15 23:47:01.606 +03:00 [DBG] Disposing connection to database 'MedicalAppDB' on server '.'.
2025-09-15 23:47:01.606 +03:00 [DBG] Disposed connection to database '' on server '' (0ms).
